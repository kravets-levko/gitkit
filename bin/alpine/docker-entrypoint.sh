#!/usr/bin/env ash

# This file is automatically generated.
# Don't edit it until you clearly understand what you're going to do.

echo 'Mapping user from host machine'

HOST_UID="$(stat -c '%u' '${GIT_REPOSITORIES_PATH}')"
HOST_GID="$(stat -c '%g' '${GIT_REPOSITORIES_PATH}')"

if [ "${HOST_UID}" == '0' ]; then
  echo 'Application files cannot be owned by root'
  exit 1
fi
if [ "${HOST_GID}" == '0' ]; then
  echo 'Application files cannot be owned by root'
  echo 1
fi

echo "Using ${HOST_UID}:${HOST_GID}"

usermod -u "${HOST_UID}" '${DOCKER_APP_USER}'
groupmod -g "${HOST_GID}" '${DOCKER_APP_GROUP}'

set -x

exec "$@"
